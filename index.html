<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>GoldDrip Global Elite</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
    <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/vant@4/lib/index.css" />
    <script src="https://fastly.jsdelivr.net/npm/vant@4/lib/vant.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --gold: #FFD700; --dark-bg: #0a0a0a; --glass: rgba(255, 255, 255, 0.05); }
        body { background: var(--dark-bg); color: #fff; font-family: sans-serif; margin: 0; padding-bottom: 90px; }
        .glass-card { background: var(--glass); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 20px; margin: 15px; }
        .gold-text { background: linear-gradient(45deg, #FFD700, #B8860B); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; }
        
        /* ØªØµÙ…ÙŠÙ… ÙƒØ±ÙˆØª VIP Ø§Ù„Ø¹ØµØ±ÙŠØ© */
        .vip-card { background: linear-gradient(135deg, rgba(255,215,0,0.1) 0%, rgba(0,0,0,0.5) 100%); border: 1px solid rgba(255,215,0,0.2); border-radius: 24px; padding: 20px; margin-bottom: 20px; position: relative; overflow: hidden; }
        .vip-card.active-plan { border-color: var(--gold); box-shadow: 0 0 15px rgba(255,215,0,0.2); }
        .vip-badge { position: absolute; top: 15px; left: -30px; background: var(--gold); color: #000; padding: 5px 40px; transform: rotate(-45deg); font-size: 10px; font-weight: bold; }
        .price-tag { font-size: 28px; font-weight: bold; color: var(--gold); }
        .feature-item { font-size: 13px; color: #ccc; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .feature-item i { color: var(--gold); font-size: 14px; }

        .floating-nav { position: fixed; bottom: 15px; left: 15px; right: 15px; background: rgba(20,20,20,0.95); border-radius: 20px; display: flex; justify-content: space-around; padding: 12px; border: 1px solid #333; z-index: 1000; }
        .nav-item { color: #666; font-size: 11px; text-align: center; }
        .nav-item.active { color: var(--gold); }
    </style>
</head>
<body>
<div id="app" v-cloak>
    <div v-if="activeTab === 'home'">
        <div class="glass-card" style="text-align: center;">
            <p style="color: #888; margin:0;">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­</p>
            <h1 class="gold-text" style="font-size: 38px; margin: 10px 0;">${{ (user?.balance || 0).toFixed(4) }}</h1>
            <div style="font-size: 12px; opacity: 0.8;">
                <span class="gold-text">VIP {{ user?.vip || 0 }}</span> | Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ†: {{ speedMultiplier }}x
            </div>
        </div>

        <div style="text-align: center; margin: 40px 0;">
            <div style="width: 150px; height: 150px; border-radius: 50%; border: 4px solid var(--gold); margin: 0 auto; display: flex; align-items: center; justify-content: center; background: radial-gradient(circle, rgba(255,215,0,0.1), transparent); cursor: pointer;" @click="mine">
                <i class="fa-solid fa-microchip" style="font-size: 60px; color: var(--gold);"></i>
            </div>
            <p style="margin-top: 15px; font-size: 12px; color: #888;">Ø§Ù†Ù‚Ø± Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ù‚Ù…ÙŠ</p>
        </div>

        <div style="display: flex; gap: 12px; padding: 0 15px;">
            <van-button block round plain color="#FFD700" @click="showWithdraw=true">Ø³Ø­Ø¨</van-button>
            <van-button block round color="linear-gradient(to right, #FFD700, #B8860B)" @click="showDeposit=true">
                <span style="color:#000; font-weight:bold">Ø¥ÙŠØ¯Ø§Ø¹</span>
            </van-button>
        </div>
    </div>

    <div v-if="activeTab === 'plans'" style="padding: 15px;">
        <h2 class="gold-text" style="text-align: center; margin-bottom: 25px;">Ø§Ù„Ø¹Ø¶ÙˆÙŠØ§Øª Ø§Ù„Ù…Ù„ÙƒÙŠØ© ğŸ‘‘</h2>
        
        <div class="vip-card">
            <div class="vip-badge">Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹</div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <b style="font-size: 20px;">Ø¹Ø¶ÙˆÙŠØ© VIP 1</b>
                <div class="price-tag">$1</div>
            </div>
            <div class="feature-item"><i class="fa-solid fa-unlock-keyhole"></i> ÙØªØ­ Ù…ÙŠØ²Ø© Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙÙˆØ±Ø§Ù‹</div>
            <div class="feature-item"><i class="fa-solid fa-chart-line"></i> Ø±Ø¨Ø­ ÙŠÙˆÙ…ÙŠ Ø«Ø§Ø¨Øª: <b>$0.15</b></div>
            <div class="feature-item"><i class="fa-solid fa-bolt"></i> Ø²ÙŠØ§Ø¯Ø© Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ† +10%</div>
            <van-button block round color="#FFD700" style="margin-top: 15px;" @click="goToDeposit('1')">
                <span style="color:#000; font-weight:bold">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¢Ù†</span>
            </van-button>
        </div>

        <div class="vip-card" style="border-color: #00ff00; background: linear-gradient(135deg, rgba(0,255,0,0.05) 0%, rgba(0,0,0,0.5) 100%);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <b style="font-size: 20px;">Ø¹Ø¶ÙˆÙŠØ© VIP 2</b>
                <div class="price-tag" style="color: #00ff00;">$5</div>
            </div>
            <div class="feature-item"><i class="fa-solid fa-infinity"></i> Ø³Ù‚Ù Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠ Ù…Ø±ØªÙØ¹ Ø¬Ø¯Ø§Ù‹</div>
            <div class="feature-item"><i class="fa-solid fa- money-bill-trend-up"></i> Ø±Ø¨Ø­ ÙŠÙˆÙ…ÙŠ Ù…Ø±ØªÙØ¹: <b>$1.00</b></div>
            <div class="feature-item"><i class="fa-solid fa-rocket"></i> Ø³Ø±Ø¹Ø© ØªØ¹Ø¯ÙŠÙ† ÙØ§Ø¦Ù‚Ø© +30%</div>
            <van-button block round color="#00ff00" style="margin-top: 15px;" @click="goToDeposit('5')">
                <span style="color:#000; font-weight:bold">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¢Ù†</span>
            </van-button>
        </div>
    </div>

    <div class="floating-nav">
        <div class="nav-item" :class="{active: activeTab==='home'}" @click="activeTab='home'"><i class="fa-solid fa-house"></i><div>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div></div>
        <div class="nav-item" :class="{active: activeTab==='plans'}" @click="activeTab='plans'"><i class="fa-solid fa-gem"></i><div>VIP</div></div>
        <div class="nav-item" :class="{active: activeTab==='about'}" @click="activeTab='about'"><i class="fa-solid fa-shield-heart"></i><div>Ø§Ù„Ø£Ù…Ø§Ù†</div></div>
    </div>

    <van-dialog v-model:show="showDeposit" title="Ø¥ÙŠØ¯Ø§Ø¹ Ø¢Ù…Ù†" show-cancel-button @confirm="confirmDeposit">
        <div style="padding: 20px; color: #333;">
            <p style="font-size:12px; margin-bottom:15px;">Ø£Ø±Ø³Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© (<b>${{selectedPlanPrice}}</b>) Ù„Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØ§Ù„ÙŠ:</p>
            <div style="background:#f5f5f5; padding:12px; border-radius:10px; font-size:10px; word-break:break-all; border:1px dashed var(--gold); text-align:center;">
                TEsCEHSkKwWTLLdEuGCHnpf23e8Sv3cZto
            </div>
            <van-field v-model="tx" label="TXID" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù‡Ù†Ø§" style="margin-top:15px;"></van-field>
        </div>
    </van-dialog>

    <div v-if="isAdmin" class="glass-card" style="border-color: red; margin-top: 50px;">
        <h4 style="color:red; margin-top:0;">Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª</h4>
        <van-field v-model="targetId" label="ID"></van-field>
        <van-field v-model="amountToAdd" label="Ø§Ù„Ù…Ø¨Ù„Øº" type="number"></van-field>
        <van-button size="small" type="primary" @click="adminAction('add_money')">Ø´Ø­Ù†</van-button>
        <van-button size="small" type="warning" @click="adminAction('set_vip')">ØªØ±Ù‚ÙŠØ© VIP</van-button>
    </div>
</div>

<script>
    const { createApp, ref, onMounted, computed } = Vue;
    const { showToast, showDialog } = vant;
    const SERVER = "https://steep-resonance-6443.alaabdalaziz01.workers.dev";
    const ADMIN_ID = "921301895";

    createApp({
        setup() {
            const user = ref({ balance: 0, referralCount: 0, vip: 0 });
            const activeTab = ref('home');
            const userId = ref("");
            const showDeposit = ref(false);
            const showWithdraw = ref(false);
            const selectedPlanPrice = ref("1");
            const tx = ref("");
            const targetId = ref("");
            const amountToAdd = ref("");

            const isAdmin = computed(() => userId.value.toString() === ADMIN_ID);
            const speedMultiplier = computed(() => (1 + (user.value?.referralCount || 0) * 0.1).toFixed(1));

            onMounted(async () => {
                if (window.Telegram?.WebApp) {
                    const tg = window.Telegram.WebApp;
                    tg.expand();
                    if (tg.initDataUnsafe?.user) {
                        userId.value = tg.initDataUnsafe.user.id;
                        await apiRequest('login');
                    }
                }
            });

            const goToDeposit = (price) => {
                selectedPlanPrice.value = price;
                showDeposit.value = true;
            };

            const apiRequest = async (action, data = {}) => {
                try {
                    const res = await fetch(SERVER, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ action, userId: userId.value, ...data })
                    });
                    const result = await res.json();
                    if (result && !result.error) {
                        user.value = result.balance !== undefined ? result : result.user;
                        return result;
                    } else if (result?.error) showToast(result.error);
                } catch (e) { console.error(e); }
            };

            const mine = () => {
                if (window.Telegram.WebApp.HapticFeedback) window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
                apiRequest('mine', { amount: 0.01 });
            };

            const confirmDeposit = async () => {
                if(!tx.value) return showToast('Ø£Ø¯Ø®Ù„ TXID');
                await apiRequest('request_deposit', { txId: tx.value });
                showDialog({ message: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨! Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙŠØ¯ÙˆÙŠØ© âœ…' });
            };

            const adminAction = async (type) => {
                let p = { adminKey: "MY_SECRET_KEY_123", userId: targetId.value };
                if (type === 'add_money') p.addBalance = parseFloat(amountToAdd.value);
                if (type === 'set_vip') p.setVip = 1;
                await apiRequest('admin_update', p);
                showToast('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« âœ…');
            };

            return { user, activeTab, isAdmin, speedMultiplier, showDeposit, showWithdraw, selectedPlanPrice, tx, targetId, amountToAdd, mine, confirmDeposit, adminAction, goToDeposit };
        }
    }).use(vant).mount('#app');
</script>
</body>
</html>
