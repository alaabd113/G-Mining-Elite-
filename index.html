<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Elite Mining</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/vant@4/lib/index.css" />
  <script src="https://unpkg.com/vant@4/lib/vant.min.js"></script>
  <style>
    [v-cloak] { display: none; }
    body { background: #0a0a0a; color: #fff; font-family: 'Arial', sans-serif; }
    .main-card { background: linear-gradient(145deg, #111, #1a1a1a); margin: 15px; border-radius: 20px; padding: 25px; border: 1px solid #ffd70033; text-align: center; }
    .mine-btn { width: 140px; height: 140px; border-radius: 50%; background: radial-gradient(#ffd700, #b8860b); border: 6px solid #222; margin: 25px auto; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; color: #000; box-shadow: 0 0 25px #ffd70044; cursor: pointer; transition: 0.2s; }
    .mine-btn:active { transform: scale(0.92); }
    .ticker { position: fixed; bottom: 0; width: 100%; background: #000; height: 38px; border-top: 1px solid #333; overflow: hidden; display: flex; align-items: center; }
    .track { display: flex; gap: 50px; animation: slide 25s linear infinite; white-space: nowrap; }
    @keyframes slide { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
  </style>
</head>
<body>
  <div id="app" v-cloak>
    <div class="main-card">
      <div style="font-size: 14px; color: #888;">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªÙˆÙØ±</div>
      <div style="font-size: 34px; font-weight: bold; color: #ffd700;">${{ user.balance }}</div>
      <div style="margin-top: 10px; font-size: 13px;">Ù…Ø³ØªÙˆÙ‰ VIP: <van-tag type="warning">{{ user.vip }}</van-tag> | Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª: {{ user.referrals }}</div>
    </div>

    <div class="mine-btn" @click="mine">START â›ï¸</div>

    <van-tabs v-model:active="activeTab" background="transparent" color="#ffd700" title-active-color="#ffd700">
      <van-tab title="Ø¥ÙŠØ¯Ø§Ø¹ ğŸ“¥">
        <div style="padding: 20px; font-size: 13px;">
          <van-divider>Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹</van-divider>
          <p>USDT (TRC20): <br><code>TEsCEHSkKwWTLLdEuGCHnpf23e8Sv3cZto</code></p>
          <p>USDT (BEP20): <br><code>0x88bea8db94f9428f282b2cc375ec68ac67fd9200</code></p>
          <van-field v-model="txid" placeholder="Ø£Ø¯Ø®Ù„ Ù‡Ø§Ø´ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (TXID)"></van-field>
          <van-radio-group v-model="net" direction="horizontal" style="margin: 10px 0;">
            <van-radio name="TRC20">TRC20</van-radio>
            <van-radio name="BEP20">BEP20</van-radio>
          </van-radio-group>
          <van-button block type="primary" size="small" @click="deposit">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</van-button>
        </div>
      </van-tab>
      
      <van-tab title="Ø³Ø­Ø¨ ğŸ“¤">
        <div style="padding: 20px;">
          <van-field v-model="wAmt" type="number" label="Ø§Ù„Ù…Ø¨Ù„Øº" placeholder="0.00"></van-field>
          <van-field v-model="wAddr" label="Ø§Ù„Ù…Ø­ÙØ¸Ø©" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©"></van-field>
          <van-button block type="success" size="small" @click="withdraw" style="margin-top: 10px;">Ø·Ù„Ø¨ Ø³Ø­Ø¨ Ø¬Ø¯ÙŠØ¯</van-button>
        </div>
      </van-tab>
    </van-tabs>

    <div class="ticker" v-if="logs.length">
      <div class="track">
        <span v-for="l in logs" style="color: #ffd700; font-size: 12px; font-weight: bold;">
          â­ VIP {{ l.vip }} â€¢ User***{{ String(l.userId).slice(-3) }} Ø³Ø­Ø¨ {{ l.amount }}$ âœ…
        </span>
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, onMounted } = Vue;
    const SERVER = "https://steep-resonance-6443.alaabdalaziz01.workers.dev";

    createApp({
      setup() {
        const user = ref({ balance: 0, vip: 0, referrals: 0 });
        const logs = ref([]);
        const activeTab = ref(0);
        const txid = ref(''), net = ref('TRC20'), wAmt = ref(''), wAddr = ref('');
        const tg = window.Telegram.WebApp;

        const api = async (action, payload = {}) => {
          const res = await fetch(SERVER, {
            method: "POST", headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ initData: tg.initData, action, payload })
          });
          const d = await res.json();
          if (d.user) user.value = d.user;
          return d;
        };

        const mine = async () => {
          const d = await api("mine");
          if (d.ok) vant.showToast("ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­! â›ï¸");
          else vant.showToast(d.error);
        };

        const deposit = async () => {
          if (!txid.value) return vant.showToast("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù‡Ø§Ø´");
          await api("deposit", { txid: txid.value, network: net.value });
          vant.showToast("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©");
          txid.value = "";
        };

        const withdraw = async () => {
          if (!wAmt.value || !wAddr.value) return vant.showToast("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
          const d = await api("withdraw", { amount: Number(wAmt.value), wallet: wAddr.value });
          if (d.ok) vant.showToast("Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©");
          else vant.showToast(d.error);
        };

        onMounted(async () => {
          tg.expand();
          await api("login", { ref: tg.initDataUnsafe?.start_param });
          const d = await api("get_ticker");
          if (d.ok) logs.value = d.items;
        });

        return { user, logs, activeTab, txid, net, wAmt, wAddr, mine, deposit, withdraw };
      }
    }).use(vant).mount("#app");
  </script>
</body>
</html>
