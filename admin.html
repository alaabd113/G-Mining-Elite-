<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>لوحة التحكم</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/vant@4/lib/index.css" />
  <script src="https://unpkg.com/vant@4/lib/vant.min.js"></script>
  <style>body { background: #111; color: #fff; padding: 20px; }</style>
</head>
<body>
  <div id="app">
    <h2 style="color: #ffd700;">⚙️ لوحة الإدارة</h2>
    <van-cell-group inset style="margin-top: 20px;">
      <van-field v-model="uid" label="ID المستخدم" placeholder="أدخل ID"></van-field>
      <van-field v-model="bal" label="إضافة رصيد" type="number" placeholder="0.00"></van-field>
      <van-field v-model="vip" label="رتبة VIP" type="digit" placeholder="0-3"></van-field>
    </van-cell-group>
    <van-button block type="primary" @click="updateUser" style="margin-top: 20px;">تحديث بيانات المستخدم</van-button>
    
    <hr style="margin: 30px 0; border: 0.5px solid #333;">
    
    <van-field v-model="wKey" label="مفتاح السحب" placeholder="انسخه من تيليجرام"></van-field>
    <van-button block type="success" @click="approve" style="margin-top: 20px;">اعتماد السحب ونشره</van-button>
  </div>

  <script>
    const { createApp, ref } = Vue;
    const SERVER = "https://your-worker-name.workers.dev"; // استبدله برابطك

    createApp({
      setup() {
        const uid = ref(''), bal = ref(''), vip = ref(''), wKey = ref('');
        const tg = window.Telegram.WebApp;

        const call = async (payload) => {
          const res = await fetch(SERVER, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ initData: tg.initData, action: "admin_action", payload })
          });
          const d = await res.json();
          vant.showToast(d.ok ? "نجحت العملية" : d.error);
        };

        const updateUser = () => call({ targetId: Number(uid.value), addBalance: Number(bal.value), setVip: Number(vip.value) });
        const approve = () => call({ approveWithdrawKey: wKey.value });

        return { uid, bal, vip, wKey, updateUser, approve };
      }
    }).use(vant).mount("#app");
  </script>
</body>
</html>
