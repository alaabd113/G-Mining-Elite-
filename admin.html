<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Admin - TokenDrip</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/vant@4/lib/index.css" />
  <script src="https://unpkg.com/vant@4/lib/vant.min.js"></script>
</head>
<body style="background: #111; color: white; padding: 20px;">
  <div id="app">
    <h3>⚙️ لوحة الأدمن</h3>
    <van-field v-model="uid" label="User ID" placeholder="ID"></van-field>
    <van-field v-model="bal" label="Add Balance" type="number" placeholder="0.00"></van-field>
    <van-button block type="primary" @click="update" style="margin-top: 10px;">تحديث</van-button>
    <hr style="margin: 20px 0; opacity: 0.2;">
    <van-field v-model="wKey" label="Withdraw Key" placeholder="انسخ المفتاح"></van-field>
    <van-button block type="success" @click="approve" style="margin-top: 10px;">اعتماد السحب</van-button>
  </div>
  <script>
    const { createApp, ref } = Vue;
    const SERVER = "https://steep-resonance-6443.alaabdalaziz01.workers.dev";
    createApp({
      setup() {
        const uid = ref(''), bal = ref(''), wKey = ref('');
        const call = async (payload) => {
          const res = await fetch(SERVER, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ initData: window.Telegram.WebApp.initData, action: "admin_action", payload }) });
          const d = await res.json();
          vant.showToast(d.ok ? "Done" : "Error");
        };
        return { uid, bal, wKey, update: () => call({ targetId: Number(uid.value), addBalance: Number(bal.value) }), approve: () => call({ approveWithdrawKey: wKey.value }) };
      }
    }).use(vant).mount("#app");
  </script>
</body>
</html>
